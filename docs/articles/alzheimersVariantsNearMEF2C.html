<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="igvR">
<title>Explore VCF variants, GWAS snps, promoters and histone marks around the  MEF2C gene in Alzheimers Disease • igvR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Explore VCF variants, GWAS snps, promoters and histone marks around the  MEF2C gene in Alzheimers Disease">
<meta property="og:description" content="igvR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">igvR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/alzheimersVariantsNearMEF2C.html">Explore VCF variants, GWAS snps, promoters and histone marks around the  MEF2C gene in Alzheimers Disease</a>
    <a class="dropdown-item" href="../articles/basicIntro.html">Introduction: a simple demo</a>
    <a class="dropdown-item" href="../articles/chooseStockOrCustomGenome.html">Choose aStock or Custom Genome</a>
    <a class="dropdown-item" href="../articles/ctcfChipSeq.html">Explore ChIP-seq alignments from a bam file, MACS2 narrowPeaks, conservation, H3K4me3 methylation and motif matching</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="alzheimersVariantsNearMEF2C_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Explore VCF variants, GWAS snps, promoters and histone marks around the  MEF2C gene in Alzheimers Disease</h1>
                        <h4 data-toc-skip class="author">Paul Shannon</h4>
            
            <h4 data-toc-skip class="date">2022-07-07</h4>
      
      
      <div class="d-none name"><code>alzheimersVariantsNearMEF2C.Rmd</code></div>
    </div>

    
    
<style>
.main-container { width: 1200px; max-width:2800px;}
</style>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The igvR package provides easy programmic access in R to the web-based javascript library <a href="https://github.com/igvteam/igv.js" class="external-link">igv.js</a> in order to create and display genome tracks in its richly interactive web browser visual interface. I am grateful to Jim Robinson, Douglass Turner and colleagues for their fine work.</p>
<p>We introduce igvR via a case study of genetic variants associated with Alzheimer’s Disease as described in the 2014 Nature Genetics paper</p>
<p>      <em>Meta-analysis of 74,046 individuals identifies 11 new susceptibility loci for Alzheimer’s disease</em><sup>1</sup></p>
<p>Theses 11 loci bring the total susceptibility loci count to 20, of which MEF2C is one. We focus on a 1 megabase region surrounding the MEF2C gene which contains 208 variants whose presence is associated with the expression of MEF2C in 17,008 Alzheimer’s disease cases and 37,154 controls. Interestingly, these variants do not occur in coding regions of the gene. Some possible insight into their function – of a highly speculative and preliminary sort - is provided by this case study. We pursue the question: could these non-coding variants alter MEF2C gene regulation by disrupting transcription factor binding sites?</p>
<p>We will proceed as follows:</p>
<ul>
<li><p>load the igvR package</p></li>
<li><p>connect to the igv.js genome browser</p></li>
<li><p>set the reference genome (hg19)</p></li>
<li><p>zoom into the MEF2C region</p></li>
<li><p>expand to display the entire 1MB region of interest</p></li>
<li><p>create our first track - the 208 SNPs - using the most primitive approach: from a base R data.frame</p></li>
<li><p>employ Bioconductor’s AnnotationHub to retrieve three methylation datasets - which are associated with open chromatin and transcription factor binding sites. From each of these datasets we create an igvR track of an approriate type - igvR’s Track class has a variety of subclasses depending on data type and data source location. Annotation, Quantitative and Variant tracks are supported here in this first (1.0) version of igvR.</p></li>
<li><p>for good measure we conclude by loading a very small slice of a different variant dataset, in VCF format, from another Alzheimer’s <a href="http://adni.loni.usc.edu/data-samples/genetic-data/wgs/" class="external-link">study</a> of 818 participants. VCF files typically contain fine-grained variant data, as is seen in the igv.js popup dialog.</p></li>
</ul>
<p>The result from running the code below:</p>
<p><img src="igvR-mef2c-Alzheimers-demo-zoomedIn.png" width="819"></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paul-shannon.github.io/igvR/" class="external-link">igvR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">MotifDb</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">BSgenome.Hsapiens.UCSC.hg19</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">VariantAnnotation</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">AnnotationHub</span><span class="op">)</span></span></code></pre></div>
<p>Create the igvR instance, with all default parameters (portRange, quiet, title). Javascript and HTML is loaded into your browser, igv.js is initialized, a websocket connection between your R process and that web page is constructed, over which subsequent commands and data will travel.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">igv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/igvR-class.html">igvR</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://paul-shannon.github.io/BrowserViz/reference/setBrowserWindowTitle.html" class="external-link">setBrowserWindowTitle</a></span><span class="op">(</span><span class="va">igv</span>, <span class="st">"MEF2C"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/setGenome.html">setGenome</a></span><span class="op">(</span><span class="va">igv</span>, <span class="st">"hg19"</span><span class="op">)</span></span></code></pre></div>
<p>Display MEF2C</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/showGenomicRegion.html">showGenomicRegion</a></span><span class="op">(</span><span class="va">igv</span>, <span class="st">"MEF2C"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="expand-the-region-on-display-create-a-granges-object-for-subsequent-genomic-queries">Expand the region on display, create a GRanges object for subsequent genomic queries<a class="anchor" aria-label="anchor" href="#expand-the-region-on-display-create-a-granges-object-for-subsequent-genomic-queries"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getGenomicRegion.html">getGenomicRegion</a></span><span class="op">(</span><span class="va">igv</span><span class="op">)</span></span>
<span><span class="va">margin</span> <span class="op">&lt;-</span> <span class="fl">25000</span></span>
<span><span class="va">bigger.loc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">loc</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s:%d-%d"</span>, <span class="va">chrom</span>, <span class="va">start</span><span class="op">-</span><span class="va">margin</span>, <span class="va">end</span><span class="op">+</span><span class="va">margin</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mef2c.region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">loc</span>, <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span>seqnames<span class="op">=</span><span class="va">chrom</span>, <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/IRanges-constructor.html" class="external-link">IRanges</a></span><span class="op">(</span>start<span class="op">=</span><span class="va">start</span><span class="op">+</span><span class="va">margin</span>, end<span class="op">=</span><span class="va">end</span><span class="op">+</span><span class="va">margin</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/showGenomicRegion.html">showGenomicRegion</a></span><span class="op">(</span><span class="va">igv</span>, <span class="va">bigger.loc</span><span class="op">)</span></span></code></pre></div>
<p>These next few steps expose the nuts and bolts of creating and displaying tracks from tabular data. None of the power and convenience of the Biocondcutor AnnotationHub, of rtracklayer and GenomicRanges is used here - that comes later in the vignette.</p>
<p>Add the IGAP GWAS track twice, first as an annotation track, so that names are avaialble by clicking, then again as a quantitative track, using a -log10(pValue) score, conveying strength of association of each SNP with the expression of the target gene, MEF2C, by the height of each SNP’s track element.</p>
<p><a href="http://consortiapedia.fastercures.org/consortia/igap/" class="external-link">IGAP</a>, the International Genomics of Alzheimer’s Project, provide these data. See <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3896259/" class="external-link">Meta-analysis of 74,046 individuals identifies 11 new susceptibility loci for Alzheimer’s disease</a>, Nature Genetics, Dec 2013.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"igvR"</span>, <span class="st">"extdata"</span>, <span class="st">"tbl.mef2cGWAS.variants.RData"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tbl.mef2cGWAS.variants.bed</span> <span class="op">&lt;-</span> <span class="va">tbl.mef2cGWAS.variants</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CHR"</span>, <span class="st">"oldPos"</span>, <span class="st">"oldPos"</span>, <span class="st">"SNP"</span>, <span class="st">"P"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">tbl.mef2cGWAS.variants.bed</span><span class="op">$</span><span class="va">P</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">tbl.mef2cGWAS.variants.bed</span><span class="op">$</span><span class="va">P</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">tbl.mef2cGWAS.variants.bed</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chrom"</span>, <span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"name"</span>, <span class="st">"score"</span><span class="op">)</span></span>
<span><span class="va">track.gwas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DataFrameAnnotationTrack-class.html">DataFrameAnnotationTrack</a></span><span class="op">(</span><span class="st">"IGAP.gwas"</span>, <span class="va">tbl.mef2cGWAS.variants.bed</span>, trackHeight<span class="op">=</span><span class="fl">20</span>, color<span class="op">=</span><span class="st">"darkBlue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/displayTrack.html">displayTrack</a></span><span class="op">(</span><span class="va">igv</span>, <span class="va">track.gwas</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl.mef2cGWAS.variants.bedGraph</span> <span class="op">&lt;-</span>  <span class="va">tbl.mef2cGWAS.variants.bed</span><span class="op">[</span>, <span class="op">-</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">track.gwas.numeric</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DataFrameQuantitativeTrack-class.html">DataFrameQuantitativeTrack</a></span><span class="op">(</span><span class="st">"IGAP.gwas.scored"</span>, <span class="va">tbl.mef2cGWAS.variants.bedGraph</span>, autoscale<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/displayTrack.html">displayTrack</a></span><span class="op">(</span><span class="va">igv</span>, <span class="va">track.gwas.numeric</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="use-the-bioc-annotationhub-to-create-a-promoter-track">Use the bioc AnnotationHub to create a promoter track<a class="anchor" aria-label="anchor" href="#use-the-bioc-annotationhub-to-create-a-promoter-track"></a>
</h2>
<p>A location-only calculation is used to identify gene promoters, rather than more nuanced experimental data, of which we will seem more later in this vignette. We use default, conservative parameters (2kb upstream of TSS, 200bp downstream).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ah</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationHub/man/AnnotationHub-class.html" class="external-link">AnnotationHub</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ah.human</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">ah</span>, <span class="va">species</span> <span class="op">==</span> <span class="st">"Homo sapiens"</span><span class="op">)</span></span>
<span><span class="co">#----------------------------------------------------------------------------------------------------</span></span>
<span><span class="co"># add refseq promoters, available from RefSeq for each transcript which has been identified</span></span>
<span><span class="co">#----------------------------------------------------------------------------------------------------</span></span>
<span><span class="va">ah.human.refseq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MotifDb/man/query.html" class="external-link">query</a></span><span class="op">(</span><span class="va">ah.human</span>, <span class="st">"RefSeq"</span>, <span class="st">"hg19"</span>, <span class="st">"RefSeq Genes"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># download the first set</span></span>
<span><span class="va">human.refseq</span> <span class="op">&lt;-</span> <span class="va">ah.human.refseq</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">gr.promoters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/intra-range-methods.html" class="external-link">promoters</a></span><span class="op">(</span><span class="va">human.refseq</span>, upstream<span class="op">=</span><span class="fl">2000</span>, downstream<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span>
<span>  <span class="co"># get rid of score, itemRgb, thick, blocks columns in the mcols, keeping just the transcript name.</span></span>
<span>  <span class="co"># these attributes are meaningful for transcript tracks since those include the represenation</span></span>
<span>  <span class="co"># of UTRs, introns and exons.   but a promoter is a stretch of DNA for which those distinctions</span></span>
<span>  <span class="co"># do not apply</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">mcols</a></span><span class="op">(</span><span class="va">gr.promoters</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">mcols</a></span><span class="op">(</span><span class="va">gr.promoters</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">mcols</a></span><span class="op">(</span><span class="va">gr.promoters</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"name"</span></span>
<span><span class="va">ov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/findOverlaps-methods.html" class="external-link">findOverlaps</a></span><span class="op">(</span><span class="va">gr.promoters</span>, <span class="va">mef2c.region</span><span class="op">)</span></span>
<span><span class="va">gr.mef2c.promoters</span> <span class="op">&lt;-</span> <span class="va">gr.promoters</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Hits-class.html" class="external-link">queryHits</a></span><span class="op">(</span><span class="va">ov</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">track.promoters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/UCSCBedAnnotationTrack-class.html">UCSCBedAnnotationTrack</a></span><span class="op">(</span><span class="st">"promoters"</span>, <span class="va">gr.mef2c.promoters</span>, color<span class="op">=</span><span class="st">"darkGreen"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/displayTrack.html">displayTrack</a></span><span class="op">(</span><span class="va">igv</span>, <span class="va">track.promoters</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="overlap-promoters-and-variants-create-new-track">Overlap promoters and variants, create new track<a class="anchor" aria-label="anchor" href="#overlap-promoters-and-variants-create-new-track"></a>
</h2>
<p>Non-coding SNPs which fall in promoter regions are plausible candidates for further examination. They may disrupt or create a transcription factor binding site, and thus possibly contribute to the disease under study.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gr.variants</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="va">tbl.mef2cGWAS.variants.bed</span><span class="op">)</span></span>
<span><span class="va">ov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/findOverlaps-methods.html" class="external-link">findOverlaps</a></span><span class="op">(</span><span class="va">gr.variants</span>, <span class="va">gr.promoters</span><span class="op">)</span></span>
<span><span class="va">gr.variantsInPromoters</span> <span class="op">&lt;-</span> <span class="va">gr.variants</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Hits-class.html" class="external-link">queryHits</a></span><span class="op">(</span><span class="va">ov</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">track.variantsInPromoters</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/GRangesAnnotationTrack-class.html">GRangesAnnotationTrack</a></span><span class="op">(</span><span class="st">"snpInPromoters"</span>, <span class="va">gr.variantsInPromoters</span>,</span>
<span>                                                   color<span class="op">=</span><span class="st">"red"</span>, displayMode<span class="op">=</span><span class="st">"EXPANDED"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/displayTrack.html">displayTrack</a></span><span class="op">(</span><span class="va">igv</span>, <span class="va">track.variantsInPromoters</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="add-methylation-tracks">Add Methylation Tracks<a class="anchor" aria-label="anchor" href="#add-methylation-tracks"></a>
</h2>
<p>H3K4me3 histone methylation marks are often associated with transcription initiation in promoter regions. We will add three tracks from the AnnotationHub for H3K4me3 methylation in <a href="https://www.genome.gov/26524238/encode-project-common-cell-types/" class="external-link">Gm12878</a> (lymphoblastoid) cells.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">histone.tracks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MotifDb/man/query.html" class="external-link">query</a></span><span class="op">(</span><span class="va">ah.human</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"H3K4me3"</span>, <span class="st">"Gm12878"</span>, <span class="st">"Peak"</span>, <span class="st">"narrow"</span><span class="op">)</span><span class="op">)</span>  <span class="co"># 3 tracks</span></span>
<span><span class="va">descriptions</span> <span class="op">&lt;-</span> <span class="va">histone.tracks</span><span class="op">$</span><span class="va">description</span></span>
<span><span class="va">titles</span> <span class="op">&lt;-</span> <span class="va">histone.tracks</span><span class="op">$</span><span class="va">title</span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">terrain.colors</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">color.index</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">histone.tracks</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">histone.tracks</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>   <span class="va">color.index</span> <span class="op">&lt;-</span> <span class="va">color.index</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>   <span class="va">gr</span> <span class="op">&lt;-</span> <span class="va">histone.tracks</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span></span>
<span>   <span class="va">ov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/findOverlaps-methods.html" class="external-link">findOverlaps</a></span><span class="op">(</span><span class="va">gr</span>, <span class="va">mef2c.region</span><span class="op">)</span></span>
<span>   <span class="va">mef2c.histones</span> <span class="op">&lt;-</span> <span class="va">gr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Hits-class.html" class="external-link">queryHits</a></span><span class="op">(</span><span class="va">ov</span><span class="op">)</span><span class="op">]</span></span>
<span>   <span class="va">track.histones</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GRangesQuantitativeTrack-class.html">GRangesQuantitativeTrack</a></span><span class="op">(</span><span class="va">titles</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">mef2c.histones</span><span class="op">[</span>, <span class="st">"pValue"</span><span class="op">]</span>,</span>
<span>                                              color<span class="op">=</span><span class="va">colors</span><span class="op">[</span><span class="va">color.index</span><span class="op">]</span>, trackHeight<span class="op">=</span><span class="fl">50</span>,</span>
<span>                                              autoscale<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>   <span class="fu"><a href="../reference/displayTrack.html">displayTrack</a></span><span class="op">(</span><span class="va">igv</span>, <span class="va">track.histones</span><span class="op">)</span></span>
<span>   <span class="op">}</span> <span class="co"># for track</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="vcf-from-adni-the-alzheimers-disease-neuroimaging-initiative">VCF from ADNI, the Alzheimer’s Disease Neuroimaging Initiative<a class="anchor" aria-label="anchor" href="#vcf-from-adni-the-alzheimers-disease-neuroimaging-initiative"></a>
</h2>
<p>We include a very small slice of the ADNI whole genome sequencing <a href="http://adni.loni.usc.edu/data-samples/genetic-data/wgs/" class="external-link">data</a>. 349 samples (filtered from a larger set of 128 AD, 415 Mild Cognitive Impairment, 267 controls, 8 uncertains) are included, all in a ~4kb region including methylation marks, and IGAP GWAS SNPs in promoter regions.</p>
<p>In order to illustrate some of genomic data exploration capabilities of igvR we are therefore mixing apples and oranges. We have GWAS variants from IGAP (a very large meta-analysis), promoters from RefSeq (conservatively defined), methylation marks from a lymphoblastoid cell line, and WGS variants from ADNI. Note also that the ADNI variants in the VCF track are not stratified by disease phenotype. Therefore, examining rsid rs80043958 at chr5:88,179,576 with an IGAP GWAS pvalue of 0.002, we see the ADNI heterozygosity is 0.269 - this and other information about that variant is displayed in a popup by clicking on the pinkish “anchor block” - keep in mind that that number would be more informative if broken out by phenotype.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vcfFilename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"igvR"</span>, <span class="st">"extdata"</span>, <span class="st">"mef2c-4kb.vcf"</span><span class="op">)</span></span>
<span><span class="va">vcf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VariantAnnotation/man/readVcf-methods.html" class="external-link">readVcf</a></span><span class="op">(</span><span class="va">vcfFilename</span>, <span class="st">"hg19"</span><span class="op">)</span></span>
<span><span class="va">track.vcf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/VariantTrack-class.html">VariantTrack</a></span><span class="op">(</span><span class="st">"AMPAD VCF"</span>, <span class="va">vcf</span>, trackHeight<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/displayTrack.html">displayTrack</a></span><span class="op">(</span><span class="va">igv</span>, <span class="va">track.vcf</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/showGenomicRegion.html">showGenomicRegion</a></span><span class="op">(</span><span class="va">igv</span>, <span class="st">"chr5:88,175,901-88,181,613"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Lambert, Jean-Charles, et al. “Meta-analysis of 74,046 individuals identifies 11 new susceptibility loci for Alzheimer’s disease.” <a href="https://www.ncbi.nlm.nih.gov/pubmed/24162737" class="external-link">Nature genetics 45.12 (2013): 1452</a>.</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Paul Shannon.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
